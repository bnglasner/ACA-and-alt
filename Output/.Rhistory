panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA))  +
scale_y_continuous(label=comma)
}
setwd(path_output)
for (i in seq_along(industry_list)) {
pdf(file = paste0("synthetic_total_estab_counterfactual",industry_list[[i]],".pdf"), width = 10, height = 8)
plot(plot1_list_estab[[i]])
dev.off()
pdf(file = paste0("synthetic_total_estab_att",industry_list[[i]],".pdf"), width = 10, height = 8)
plot(plot2_list_estab[[i]])
dev.off()
pdf(file = paste0("synthetic_total_rcp_counterfactual",industry_list[[i]],".pdf"), width = 10, height = 8)
plot(plot1_list_rcp[[i]])
dev.off()
pdf(file = paste0("synthetic_total_rcp_att",industry_list[[i]],".pdf"), width = 10, height = 8)
plot(plot2_list_rcp[[i]])
dev.off()
}
ATT <- c(as.numeric(estab_list[[1]]$att.avg),as.numeric(estab_list[[2]]$att.avg),as.numeric(estab_list[[3]]$att.avg),
as.numeric(estab_list[[4]]$att.avg),as.numeric(estab_list[[5]]$att.avg),as.numeric(estab_list[[6]]$att.avg),
as.numeric(estab_list[[7]]$att.avg),as.numeric(estab_list[[8]]$att.avg),as.numeric(estab_list[[9]]$att.avg),
as.numeric(estab_list[[10]]$att.avg),as.numeric(estab_list[[11]]$att.avg),as.numeric(estab_list[[12]]$att.avg),
as.numeric(estab_list[[13]]$att.avg),as.numeric(estab_list[[14]]$att.avg),as.numeric(estab_list[[15]]$att.avg),
as.numeric(estab_list[[16]]$att.avg),as.numeric(estab_list[[17]]$att.avg),as.numeric(estab_list[[18]]$att.avg),
as.numeric(estab_list[[19]]$att.avg))
SE <- c(as.numeric(sd(estab_list[[1]]$att.avg.boot)),as.numeric(sd(estab_list[[2]]$att.avg.boot)),as.numeric(sd(estab_list[[3]]$att.avg.boot)),
as.numeric(sd(estab_list[[4]]$att.avg.boot)),as.numeric(sd(estab_list[[5]]$att.avg.boot)),as.numeric(sd(estab_list[[6]]$att.avg.boot)),
as.numeric(sd(estab_list[[7]]$att.avg.boot)),as.numeric(sd(estab_list[[8]]$att.avg.boot)),as.numeric(sd(estab_list[[9]]$att.avg.boot)),
as.numeric(sd(estab_list[[10]]$att.avg.boot)),as.numeric(sd(estab_list[[11]]$att.avg.boot)),as.numeric(sd(estab_list[[12]]$att.avg.boot)),
as.numeric(sd(estab_list[[13]]$att.avg.boot)),as.numeric(sd(estab_list[[14]]$att.avg.boot)),as.numeric(sd(estab_list[[15]]$att.avg.boot)),
as.numeric(sd(estab_list[[16]]$att.avg.boot)),as.numeric(sd(estab_list[[17]]$att.avg.boot)),as.numeric(sd(estab_list[[18]]$att.avg.boot)),
as.numeric(sd(estab_list[[19]]$att.avg.boot)))
ci.lower <- c(-0.02125,-0.0004365,-0.0004332,
-0.00005808, -0.001992, -0.0001309,
-0.002179, -0.0007248, -0.01078,
-0.001429, -0.001495, -0.002028,
-0.004194, -0.004652, -0.001712,
-0.002635, -0.001757, -0.0008405,
-0.005251)
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
ci.higher <- c(-0.005794,0.001882 ,0.002597,
0.0001078, 0.001902, 0.002354,
0.0003338, 0.001151, 0.0003395,
-0.00000648, 0.00007454, -0.0004721,
-0.0008238, -0.0002566, 0.00002139,
0.000393, -0.0002786, -0.00009943,
-0.0006706)
Bar_plot_estab <- data.frame(cbind(industry_name,ATT,SE, ci.lower,ci.higher,labor.force_med2018))
print(estab_list[[1]])
print(estab_list[[2]])
print(estab_list[[3]])
print(estab_list[[4]])
print(estab_list[[5]])
print(estab_list[[6]])
print(estab_list[[7]])
print(estab_list[[8]])
print(estab_list[[9]])
print(estab_list[[10]])
print(estab_list[[11]])
print(estab_list[[12]])
print(estab_list[[13]])
print(estab_list[[14]])
print(estab_list[[15]])
print(estab_list[[16]])
print(estab_list[[17]])
print(estab_list[[18]])
print(estab_list[[19]])
ci.lower <- c(-0.01206,-0.0003235,-0.0001824,
-0.0001015, -0.000257, -0.00003605,
0.000137, -0.0004234, 0.0003164,
-0.0004323, -0.000264, -0.002236,
-0.002195, -0.002887, -0.001228,
-0.002748, -0.0005292, -0.0009642,
-0.006496)
ci.higher <- c(-0.00191,0.0009452 ,0.0005917,
-0.000004067, 0.0007623, 0.001265,
0.0006582, 0.001151, 0.003343,
-0.000007554, 0.00003801, -0.0005496,
-0.0001735, 0.0006518 , -0.00009414,
-0.000486, 0.00009227, -0.0001884,
-0.001123)
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_estab <- data.frame(cbind(industry_name,ATT,SE, ci.lower,ci.higher,labor.force_med2018))
ATT <- c(as.numeric(rcp_list[[1]]$att.avg),as.numeric(rcp_list[[2]]$att.avg),as.numeric(rcp_list[[3]]$att.avg),
as.numeric(rcp_list[[4]]$att.avg),as.numeric(rcp_list[[5]]$att.avg),as.numeric(rcp_list[[6]]$att.avg),
as.numeric(rcp_list[[7]]$att.avg),as.numeric(rcp_list[[8]]$att.avg),as.numeric(rcp_list[[9]]$att.avg),
as.numeric(rcp_list[[10]]$att.avg),as.numeric(rcp_list[[11]]$att.avg),as.numeric(rcp_list[[12]]$att.avg),
as.numeric(rcp_list[[13]]$att.avg),as.numeric(rcp_list[[14]]$att.avg),as.numeric(rcp_list[[15]]$att.avg),
as.numeric(rcp_list[[16]]$att.avg),as.numeric(rcp_list[[17]]$att.avg),as.numeric(rcp_list[[18]]$att.avg),
as.numeric(rcp_list[[19]]$att.avg))
SE <- c(as.numeric(sd(rcp_list[[1]]$att.avg.boot)),as.numeric(sd(rcp_list[[2]]$att.avg.boot)),as.numeric(sd(rcp_list[[3]]$att.avg.boot)),
as.numeric(sd(rcp_list[[4]]$att.avg.boot)),as.numeric(sd(rcp_list[[5]]$att.avg.boot)),as.numeric(sd(rcp_list[[6]]$att.avg.boot)),
as.numeric(sd(rcp_list[[7]]$att.avg.boot)),as.numeric(sd(rcp_list[[8]]$att.avg.boot)),as.numeric(sd(rcp_list[[9]]$att.avg.boot)),
as.numeric(sd(rcp_list[[10]]$att.avg.boot)),as.numeric(sd(rcp_list[[11]]$att.avg.boot)),as.numeric(sd(rcp_list[[12]]$att.avg.boot)),
as.numeric(sd(rcp_list[[13]]$att.avg.boot)),as.numeric(sd(rcp_list[[14]]$att.avg.boot)),as.numeric(sd(rcp_list[[15]]$att.avg.boot)),
as.numeric(sd(rcp_list[[16]]$att.avg.boot)),as.numeric(sd(rcp_list[[17]]$att.avg.boot)),as.numeric(sd(rcp_list[[18]]$att.avg.boot)),
as.numeric(sd(rcp_list[[19]]$att.avg.boot)))
print(rcp_list[[1]])
print(rcp_list[[2]])
print(rcp_list[[3]])
print(rcp_list[[4]])
print(rcp_list[[5]])
print(rcp_list[[6]])
print(rcp_list[[7]])
print(rcp_list[[8]])
print(rcp_list[[9]])
print(rcp_list[[10]])
print(rcp_list[[11]])
print(rcp_list[[12]])
print(rcp_list[[13]])
print(rcp_list[[14]])
print(rcp_list[[15]])
print(rcp_list[[16]])
print(rcp_list[[17]])
print(rcp_list[[18]])
print(rcp_list[[19]])
print(rcp_list[[1]])
ci.lower <- c(-901.4,-2345,-15470,
-668.9, -3512, -3589,
-2847, 517.8, -3494,
-10846, -6443, -4527,
462.3, 29.92, -1594,
-1872, -1481, -4192,
-613)
ci.higher <- c(2443,1902,15110,
42415, 4375, 935.4,
7546 ,  4079, 4610,
-1728, 3283, 4617,
4041, 1558, 1541,
1944, 1044,  8073,
1414)
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_rcp <- data.frame(cbind(industry_name,ATT,SE, ci.lower,ci.higher,labor.force_med2018))
#######
Bar_plot_estab$x <- "Estab. (Thousands)"
Bar_plot_estab$ATT <- Bar_plot_estab$ATT*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_estab$ci.lower <- Bar_plot_estab$ci.lower*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_estab$ci.higher <- Bar_plot_estab$ci.higher*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_rcp$x <- "Average Receipts"
Bar_plot <- rbind(Bar_plot_estab,Bar_plot_rcp)
Bar_plot <- merge(Bar_plot, estab_counts)
Bar_plot <- merge(Bar_plot, rcptot_counts)
Bar_plot$avgrcp <- (Bar_plot$rcptot/Bar_plot$estab)*1000
Bar_plot$estab <- Bar_plot$estab/1000
Bar_plot$ATT_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ATT[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ci.lower_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ci.lower[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ci.higher_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ci.higher[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ATT_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ATT[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot$ci.lower_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ci.lower[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot$ci.higher_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ci.higher[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot <- Bar_plot[-c(5,6,7,8),]
p1 <- ggplot(data = Bar_plot,
aes(y = industry_names)) +
geom_vline(xintercept = 0, color = "red") +
geom_point(aes(x = ATT), size = 2) +
geom_errorbarh(aes(xmax = ci.higher, xmin = ci.lower, height = .4)) +
ylab("NAICS Industry") + xlab("Effect of Medicaid Expansion") +
theme(plot.title = element_text(size=20),
axis.text = element_text(size = 20),
axis.title.y = element_text(size = 30, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(size = 30, margin = margin(t = 20, r = 0, b = 0, l = 0)),
strip.text.x = element_text(size = 30),
strip.text.y = element_text(size = 30),
strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
panel.spacing = unit(3, "lines"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA)) +
scale_x_continuous(label=comma) +
facet_wrap( ~ x, scales = "free_x")
plot(p1)
setwd(path_output)
pdf(file = paste0("synthetic_results_ATT_avg.pdf"), width = 18, height = 15)
plot(p1)
dev.off()
p2 <- ggplot(data = Bar_plot,
aes(y = industry_names)) +
geom_vline(xintercept = 0, color = "red") +
geom_point(aes(x = ATT_perc), size = 2) +
geom_errorbarh(aes(xmax = ci.higher_perc, xmin = ci.lower_perc, height = .4)) +
ylab("NAICS Industry") + xlab("Effect of Medicaid Expansion") +
theme(plot.title = element_text(size=20),
axis.text = element_text(size = 20),
axis.title.y = element_text(size = 30, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(size = 30, margin = margin(t = 20, r = 0, b = 0, l = 0)),
strip.text.x = element_text(size = 30),
strip.text.y = element_text(size = 30),
strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
panel.spacing = unit(3, "lines"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA)) +
scale_x_continuous(label=percent) +
facet_wrap( ~ x, scales = "free_x")
setwd(path_output)
pdf(file = paste0("synthetic_results_ATT_avg_perc.pdf"), width = 18, height = 15)
plot(p2)
dev.off()
plot(p2)
industry_name
print(estab_list[[5]])
ci.higher <- c(-0.00191,0.0009452 ,0.0005917,
-0.000004067, 0.001968, 0.001265,
0.0006582, 0.001151, 0.003343,
-0.000007554, 0.00003801, -0.0005496,
-0.0001735, 0.0006518 , -0.00009414,
-0.000486, 0.00009227, -0.0001884,
-0.001123)
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_estab <- data.frame(cbind(industry_name,ATT,SE, ci.lower,ci.higher,labor.force_med2018))
ATT <- c(as.numeric(rcp_list[[1]]$att.avg),as.numeric(rcp_list[[2]]$att.avg),as.numeric(rcp_list[[3]]$att.avg),
as.numeric(rcp_list[[4]]$att.avg),as.numeric(rcp_list[[5]]$att.avg),as.numeric(rcp_list[[6]]$att.avg),
as.numeric(rcp_list[[7]]$att.avg),as.numeric(rcp_list[[8]]$att.avg),as.numeric(rcp_list[[9]]$att.avg),
as.numeric(rcp_list[[10]]$att.avg),as.numeric(rcp_list[[11]]$att.avg),as.numeric(rcp_list[[12]]$att.avg),
as.numeric(rcp_list[[13]]$att.avg),as.numeric(rcp_list[[14]]$att.avg),as.numeric(rcp_list[[15]]$att.avg),
as.numeric(rcp_list[[16]]$att.avg),as.numeric(rcp_list[[17]]$att.avg),as.numeric(rcp_list[[18]]$att.avg),
as.numeric(rcp_list[[19]]$att.avg))
SE <- c(as.numeric(sd(rcp_list[[1]]$att.avg.boot)),as.numeric(sd(rcp_list[[2]]$att.avg.boot)),as.numeric(sd(rcp_list[[3]]$att.avg.boot)),
as.numeric(sd(rcp_list[[4]]$att.avg.boot)),as.numeric(sd(rcp_list[[5]]$att.avg.boot)),as.numeric(sd(rcp_list[[6]]$att.avg.boot)),
as.numeric(sd(rcp_list[[7]]$att.avg.boot)),as.numeric(sd(rcp_list[[8]]$att.avg.boot)),as.numeric(sd(rcp_list[[9]]$att.avg.boot)),
as.numeric(sd(rcp_list[[10]]$att.avg.boot)),as.numeric(sd(rcp_list[[11]]$att.avg.boot)),as.numeric(sd(rcp_list[[12]]$att.avg.boot)),
as.numeric(sd(rcp_list[[13]]$att.avg.boot)),as.numeric(sd(rcp_list[[14]]$att.avg.boot)),as.numeric(sd(rcp_list[[15]]$att.avg.boot)),
as.numeric(sd(rcp_list[[16]]$att.avg.boot)),as.numeric(sd(rcp_list[[17]]$att.avg.boot)),as.numeric(sd(rcp_list[[18]]$att.avg.boot)),
as.numeric(sd(rcp_list[[19]]$att.avg.boot)))
ci.lower <- c(-901.4,-2345,-15470,
-668.9, -3512, -3589,
-2847, 517.8, -3494,
-10846, -6443, -4527,
462.3, 29.92, -1594,
-1872, -1481, -4192,
-613)
ci.higher <- c(2443,1902,15110,
42415, 4375, 935.4,
7546 ,  4079, 4610,
-1728, 3283, 4617,
4041, 1558, 1541,
1944, 1044,  8073,
1414)
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_rcp <- data.frame(cbind(industry_name,ATT,SE, ci.lower,ci.higher,labor.force_med2018))
#######
Bar_plot_estab$x <- "Estab. (Thousands)"
Bar_plot_estab$ATT <- Bar_plot_estab$ATT*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_estab$ci.lower <- Bar_plot_estab$ci.lower*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_estab$ci.higher <- Bar_plot_estab$ci.higher*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_rcp$x <- "Average Receipts"
Bar_plot <- rbind(Bar_plot_estab,Bar_plot_rcp)
Bar_plot <- merge(Bar_plot, estab_counts)
Bar_plot <- merge(Bar_plot, rcptot_counts)
Bar_plot$avgrcp <- (Bar_plot$rcptot/Bar_plot$estab)*1000
Bar_plot$estab <- Bar_plot$estab/1000
Bar_plot$ATT_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ATT[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ci.lower_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ci.lower[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ci.higher_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ci.higher[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ATT_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ATT[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot$ci.lower_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ci.lower[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot$ci.higher_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ci.higher[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot <- Bar_plot[-c(5,6,7,8),]
p1 <- ggplot(data = Bar_plot,
aes(y = industry_names)) +
geom_vline(xintercept = 0, color = "red") +
geom_point(aes(x = ATT), size = 2) +
geom_errorbarh(aes(xmax = ci.higher, xmin = ci.lower, height = .4)) +
ylab("NAICS Industry") + xlab("Effect of Medicaid Expansion") +
theme(plot.title = element_text(size=20),
axis.text = element_text(size = 20),
axis.title.y = element_text(size = 30, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(size = 30, margin = margin(t = 20, r = 0, b = 0, l = 0)),
strip.text.x = element_text(size = 30),
strip.text.y = element_text(size = 30),
strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
panel.spacing = unit(3, "lines"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA)) +
scale_x_continuous(label=comma) +
facet_wrap( ~ x, scales = "free_x")
setwd(path_output)
pdf(file = paste0("synthetic_results_ATT_avg.pdf"), width = 18, height = 15)
plot(p1)
dev.off()
p2 <- ggplot(data = Bar_plot,
aes(y = industry_names)) +
geom_vline(xintercept = 0, color = "red") +
geom_point(aes(x = ATT_perc), size = 2) +
geom_errorbarh(aes(xmax = ci.higher_perc, xmin = ci.lower_perc, height = .4)) +
ylab("NAICS Industry") + xlab("Effect of Medicaid Expansion") +
theme(plot.title = element_text(size=20),
axis.text = element_text(size = 20),
axis.title.y = element_text(size = 30, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(size = 30, margin = margin(t = 20, r = 0, b = 0, l = 0)),
strip.text.x = element_text(size = 30),
strip.text.y = element_text(size = 30),
strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
panel.spacing = unit(3, "lines"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA)) +
scale_x_continuous(label=percent) +
facet_wrap( ~ x, scales = "free_x")
setwd(path_output)
pdf(file = paste0("synthetic_results_ATT_avg_perc.pdf"), width = 18, height = 15)
plot(p2)
dev.off()
plot(p2)
ATT <- c(as.numeric(rcp_list[[1]]$att.avg),as.numeric(rcp_list[[2]]$att.avg),as.numeric(rcp_list[[3]]$att.avg),
as.numeric(rcp_list[[4]]$att.avg),as.numeric(rcp_list[[5]]$att.avg),as.numeric(rcp_list[[6]]$att.avg),
as.numeric(rcp_list[[7]]$att.avg),as.numeric(rcp_list[[8]]$att.avg),as.numeric(rcp_list[[9]]$att.avg),
as.numeric(rcp_list[[10]]$att.avg),as.numeric(rcp_list[[11]]$att.avg),as.numeric(rcp_list[[12]]$att.avg),
as.numeric(rcp_list[[13]]$att.avg),as.numeric(rcp_list[[14]]$att.avg),as.numeric(rcp_list[[15]]$att.avg),
as.numeric(rcp_list[[16]]$att.avg),as.numeric(rcp_list[[17]]$att.avg),as.numeric(rcp_list[[18]]$att.avg),
as.numeric(rcp_list[[19]]$att.avg))
SE <- c(as.numeric(sd(rcp_list[[1]]$att.avg.boot)),as.numeric(sd(rcp_list[[2]]$att.avg.boot)),as.numeric(sd(rcp_list[[3]]$att.avg.boot)),
as.numeric(sd(rcp_list[[4]]$att.avg.boot)),as.numeric(sd(rcp_list[[5]]$att.avg.boot)),as.numeric(sd(rcp_list[[6]]$att.avg.boot)),
as.numeric(sd(rcp_list[[7]]$att.avg.boot)),as.numeric(sd(rcp_list[[8]]$att.avg.boot)),as.numeric(sd(rcp_list[[9]]$att.avg.boot)),
as.numeric(sd(rcp_list[[10]]$att.avg.boot)),as.numeric(sd(rcp_list[[11]]$att.avg.boot)),as.numeric(sd(rcp_list[[12]]$att.avg.boot)),
as.numeric(sd(rcp_list[[13]]$att.avg.boot)),as.numeric(sd(rcp_list[[14]]$att.avg.boot)),as.numeric(sd(rcp_list[[15]]$att.avg.boot)),
as.numeric(sd(rcp_list[[16]]$att.avg.boot)),as.numeric(sd(rcp_list[[17]]$att.avg.boot)),as.numeric(sd(rcp_list[[18]]$att.avg.boot)),
as.numeric(sd(rcp_list[[19]]$att.avg.boot)))
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_rcp <- data.frame(cbind(industry_name,ATT,SE,labor.force_med2018))
View(Bar_plot_rcp)
Bar_plot_rcp$ci.higher <- Bar_plot_rcp$ATT + 1.96*Bar_plot_rcp$SE
Bar_plot_rcp$ci.lower <- Bar_plot_rcp$ATT - 1.96*Bar_plot_rcp$SE
ATT <- c(as.numeric(estab_list[[1]]$att.avg),as.numeric(estab_list[[2]]$att.avg),as.numeric(estab_list[[3]]$att.avg),
as.numeric(estab_list[[4]]$att.avg),as.numeric(estab_list[[5]]$att.avg),as.numeric(estab_list[[6]]$att.avg),
as.numeric(estab_list[[7]]$att.avg),as.numeric(estab_list[[8]]$att.avg),as.numeric(estab_list[[9]]$att.avg),
as.numeric(estab_list[[10]]$att.avg),as.numeric(estab_list[[11]]$att.avg),as.numeric(estab_list[[12]]$att.avg),
as.numeric(estab_list[[13]]$att.avg),as.numeric(estab_list[[14]]$att.avg),as.numeric(estab_list[[15]]$att.avg),
as.numeric(estab_list[[16]]$att.avg),as.numeric(estab_list[[17]]$att.avg),as.numeric(estab_list[[18]]$att.avg),
as.numeric(estab_list[[19]]$att.avg))
SE <- c(as.numeric(sd(estab_list[[1]]$att.avg.boot)),as.numeric(sd(estab_list[[2]]$att.avg.boot)),as.numeric(sd(estab_list[[3]]$att.avg.boot)),
as.numeric(sd(estab_list[[4]]$att.avg.boot)),as.numeric(sd(estab_list[[5]]$att.avg.boot)),as.numeric(sd(estab_list[[6]]$att.avg.boot)),
as.numeric(sd(estab_list[[7]]$att.avg.boot)),as.numeric(sd(estab_list[[8]]$att.avg.boot)),as.numeric(sd(estab_list[[9]]$att.avg.boot)),
as.numeric(sd(estab_list[[10]]$att.avg.boot)),as.numeric(sd(estab_list[[11]]$att.avg.boot)),as.numeric(sd(estab_list[[12]]$att.avg.boot)),
as.numeric(sd(estab_list[[13]]$att.avg.boot)),as.numeric(sd(estab_list[[14]]$att.avg.boot)),as.numeric(sd(estab_list[[15]]$att.avg.boot)),
as.numeric(sd(estab_list[[16]]$att.avg.boot)),as.numeric(sd(estab_list[[17]]$att.avg.boot)),as.numeric(sd(estab_list[[18]]$att.avg.boot)),
as.numeric(sd(estab_list[[19]]$att.avg.boot)))
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_estab <- data.frame(cbind(industry_name,ATT,SE,labor.force_med2018))
Bar_plot_estab$ci.higher <- Bar_plot_estab$ATT + 1.96*Bar_plot_estab$SE
Bar_plot_estab$ci.lower <- Bar_plot_estab$ATT - 1.96*Bar_plot_estab$SE
#######
ATT <- c(as.numeric(rcp_list[[1]]$att.avg),as.numeric(rcp_list[[2]]$att.avg),as.numeric(rcp_list[[3]]$att.avg),
as.numeric(rcp_list[[4]]$att.avg),as.numeric(rcp_list[[5]]$att.avg),as.numeric(rcp_list[[6]]$att.avg),
as.numeric(rcp_list[[7]]$att.avg),as.numeric(rcp_list[[8]]$att.avg),as.numeric(rcp_list[[9]]$att.avg),
as.numeric(rcp_list[[10]]$att.avg),as.numeric(rcp_list[[11]]$att.avg),as.numeric(rcp_list[[12]]$att.avg),
as.numeric(rcp_list[[13]]$att.avg),as.numeric(rcp_list[[14]]$att.avg),as.numeric(rcp_list[[15]]$att.avg),
as.numeric(rcp_list[[16]]$att.avg),as.numeric(rcp_list[[17]]$att.avg),as.numeric(rcp_list[[18]]$att.avg),
as.numeric(rcp_list[[19]]$att.avg))
SE <- c(as.numeric(sd(rcp_list[[1]]$att.avg.boot)),as.numeric(sd(rcp_list[[2]]$att.avg.boot)),as.numeric(sd(rcp_list[[3]]$att.avg.boot)),
as.numeric(sd(rcp_list[[4]]$att.avg.boot)),as.numeric(sd(rcp_list[[5]]$att.avg.boot)),as.numeric(sd(rcp_list[[6]]$att.avg.boot)),
as.numeric(sd(rcp_list[[7]]$att.avg.boot)),as.numeric(sd(rcp_list[[8]]$att.avg.boot)),as.numeric(sd(rcp_list[[9]]$att.avg.boot)),
as.numeric(sd(rcp_list[[10]]$att.avg.boot)),as.numeric(sd(rcp_list[[11]]$att.avg.boot)),as.numeric(sd(rcp_list[[12]]$att.avg.boot)),
as.numeric(sd(rcp_list[[13]]$att.avg.boot)),as.numeric(sd(rcp_list[[14]]$att.avg.boot)),as.numeric(sd(rcp_list[[15]]$att.avg.boot)),
as.numeric(sd(rcp_list[[16]]$att.avg.boot)),as.numeric(sd(rcp_list[[17]]$att.avg.boot)),as.numeric(sd(rcp_list[[18]]$att.avg.boot)),
as.numeric(sd(rcp_list[[19]]$att.avg.boot)))
labor.force_med2018 <- c(98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447, 98219447, 98219447,
98219447)
Bar_plot_rcp <- data.frame(cbind(industry_name,ATT,SE,labor.force_med2018))
Bar_plot_rcp$ci.higher <- Bar_plot_rcp$ATT + 1.96*Bar_plot_rcp$SE
Bar_plot_rcp$ci.lower <- Bar_plot_rcp$ATT - 1.96*Bar_plot_rcp$SE
#######
Bar_plot_estab$x <- "Estab. (Thousands)"
Bar_plot_estab$ATT <- Bar_plot_estab$ATT*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_estab$ci.lower <- Bar_plot_estab$ci.lower*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_estab$ci.higher <- Bar_plot_estab$ci.higher*Bar_plot_estab$labor.force_med2018/1000
Bar_plot_rcp$x <- "Average Receipts"
Bar_plot <- rbind(Bar_plot_estab,Bar_plot_rcp)
Bar_plot <- merge(Bar_plot, estab_counts)
Bar_plot <- merge(Bar_plot, rcptot_counts)
Bar_plot$avgrcp <- (Bar_plot$rcptot/Bar_plot$estab)*1000
Bar_plot$estab <- Bar_plot$estab/1000
Bar_plot$ATT_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ATT[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ci.lower_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ci.lower[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ci.higher_perc[Bar_plot$x=="Estab. (Thousands)"] <- Bar_plot$ci.higher[Bar_plot$x=="Estab. (Thousands)"]/Bar_plot$estab[Bar_plot$x=="Estab. (Thousands)"]
Bar_plot$ATT_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ATT[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot$ci.lower_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ci.lower[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot$ci.higher_perc[Bar_plot$x=="Average Receipts"] <- Bar_plot$ci.higher[Bar_plot$x=="Average Receipts"]/Bar_plot$avgrcp[Bar_plot$x=="Average Receipts"]
Bar_plot <- Bar_plot[-c(5,6,7,8),]
p1 <- ggplot(data = Bar_plot,
aes(y = industry_names)) +
geom_vline(xintercept = 0, color = "red") +
geom_point(aes(x = ATT), size = 2) +
geom_errorbarh(aes(xmax = ci.higher, xmin = ci.lower, height = .4)) +
ylab("NAICS Industry") + xlab("Effect of Medicaid Expansion") +
theme(plot.title = element_text(size=20),
axis.text = element_text(size = 20),
axis.title.y = element_text(size = 30, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(size = 30, margin = margin(t = 20, r = 0, b = 0, l = 0)),
strip.text.x = element_text(size = 30),
strip.text.y = element_text(size = 30),
strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
panel.spacing = unit(3, "lines"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA)) +
scale_x_continuous(label=comma) +
facet_wrap( ~ x, scales = "free_x")
setwd(path_output)
pdf(file = paste0("synthetic_results_ATT_avg.pdf"), width = 18, height = 15)
plot(p1)
dev.off()
p2 <- ggplot(data = Bar_plot,
aes(y = industry_names)) +
geom_vline(xintercept = 0, color = "red") +
geom_point(aes(x = ATT_perc), size = 2) +
geom_errorbarh(aes(xmax = ci.higher_perc, xmin = ci.lower_perc, height = .4)) +
ylab("NAICS Industry") + xlab("Effect of Medicaid Expansion") +
theme(plot.title = element_text(size=20),
axis.text = element_text(size = 20),
axis.title.y = element_text(size = 30, margin = margin(t = 0, r = 20, b = 0, l = 0)),
axis.title.x = element_text(size = 30, margin = margin(t = 20, r = 0, b = 0, l = 0)),
strip.text.x = element_text(size = 30),
strip.text.y = element_text(size = 30),
strip.background = element_rect(fill = "white"),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
panel.spacing = unit(3, "lines"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.title = element_blank(),
legend.key = element_rect(fill="white"),
legend.text = element_text(size = 20),
legend.background = element_rect(fill=NA)) +
scale_x_continuous(label=percent) +
facet_wrap( ~ x, scales = "free_x")
setwd(path_output)
pdf(file = paste0("synthetic_results_ATT_avg_perc.pdf"), width = 18, height = 15)
plot(p2)
dev.off()
p1
p2
print(estab_list[[1]])
