synth_list <- list()
synth_Uber_list <- list()
estab_tidy_list <- list()
load("medicaid_analysis_data_total.RData")
industry_list <- sort(unique(using$naics))
#################################################################
#                              Industry                         #
#################################################################
setwd(paste0(path_data))
print(paste0(industry_list[i],"start"))
names(using)
# Create column for active Uber at the time of observation
using$uber_year <- year(ymd(using$min_uber)) # pull the year number from the date object "min"
# Ben Glasner
# Medicaid and nonemployers analysis
# Desccriptive paths
# Set up
#################################################
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(scales)
library(readxl)
library(lubridate)
library(dummies)
options(scipen=10000)
#################
### Set paths ###
#################
if(Sys.info()[["user"]]=="bglasner"){
# Root folder
path_project <- "C:/Users/bglasner/Dropbox/PhD Requirements"
}
if(Sys.info()[["user"]]=="bngla"){
# Root folder
path_project <- "C:/Users/bngla/Dropbox/PhD Requirements"
}
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
if(Sys.info()[["nodename"]]=="SIM1"){
# Root folder
path_project <- "H:/Phd Requirements min wage"
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
}
if(Sys.info()[["nodename"]]=="SIM2"){
# Root folder
path_project <- "H:/Phd Requirements min wage"
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
}
if(Sys.info()[["nodename"]]=="SIM3"){
# Root folder
path_project <- "H:/Phd Requirements min wage"
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
}
setwd(paste0(path_data))
set.seed(99199)
#################################################################
#                              Set Up                           #
#################################################################
synth_list <- list()
synth_Uber_list <- list()
estab_tidy_list <- list()
load("medicaid_analysis_data_total.RData")
industry_list <- sort(unique(using$naics))
##########################################################################
### Identify which counties will eventually get the medicaid expansion ###
##########################################################################
setwd(paste0(path_output))
medicaid_ever <- subset(medicaid, YEAR.id==2018)
medicaid_ever <- subset(using, YEAR.id==2018 & Medicaid==1)
medicaid_ever$Medicaid_ever <- medicaid_ever$Medicaid
medicaid_ever <- medicaid_ever %>% dplyr::select("st", "Medicaid_ever")
using_model <- merge(using_model, medicaid_ever)
using_model <- merge(using, medicaid_ever)
rm(using_model)
View(using)
View(medicaid_ever)
medicaid_ever <- unique(medicaid_ever)
using_model <- merge(using, medicaid_ever)
View(using_model)
using_model <- merge(using, medicaid_ever, all = TRUE)
using_model$Medicaid_ever[using_model$Medicaid_ever ==0] <- "No Medicaid Expansion"
using_model$Medicaid_ever[using_model$Medicaid_ever ==1] <- "Medicaid Expansion"
trends <- aggregate(x=using_model$estab_pop, by = list(using_model$YEAR.id, using_model$Medicaid_ever, using_model$Ever_Uber, using_model$Urban), FUN = mean)
trends <- aggregate(x=using_model$estab_pop, by = list(using_model$YEAR.id, using_model$Medicaid_ever), FUN = mean)
View(trends)
medicaid_ever <- subset(using, YEAR.id==2018 & Medicaid==1)
medicaid_ever$Medicaid_ever <- medicaid_ever$Medicaid
medicaid_ever <- medicaid_ever %>% dplyr::select("st", "Medicaid_ever")
medicaid_ever <- unique(medicaid_ever)
using_model <- merge(using, medicaid_ever, all = TRUE)
using_model$Medicaid_ever[using_model$Medicaid_ever ==0] <- "No Medicaid Expansion"
using_model$Medicaid_ever[using_model$Medicaid_ever ==1] <- "Medicaid Expansion"
View(using_model)
View(using_model)
# Ben Glasner
# Medicaid and nonemployers analysis
# Desccriptive paths
# Set up
#################################################
library(dplyr)
library(ggplot2)
library(RColorBrewer)
library(scales)
library(readxl)
library(lubridate)
library(dummies)
options(scipen=10000)
#################
### Set paths ###
#################
if(Sys.info()[["user"]]=="bglasner"){
# Root folder
path_project <- "C:/Users/bglasner/Dropbox/PhD Requirements"
}
if(Sys.info()[["user"]]=="bngla"){
# Root folder
path_project <- "C:/Users/bngla/Dropbox/PhD Requirements"
}
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
if(Sys.info()[["nodename"]]=="SIM1"){
# Root folder
path_project <- "H:/Phd Requirements min wage"
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
}
if(Sys.info()[["nodename"]]=="SIM2"){
# Root folder
path_project <- "H:/Phd Requirements min wage"
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
}
if(Sys.info()[["nodename"]]=="SIM3"){
# Root folder
path_project <- "H:/Phd Requirements min wage"
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
}
setwd(paste0(path_data))
set.seed(99199)
#################################################################
#                              Set Up                           #
#################################################################
synth_list <- list()
synth_Uber_list <- list()
estab_tidy_list <- list()
load("medicaid_analysis_data_total.RData")
industry_list <- sort(unique(using$naics))
View(using)
using$Medicaid_ever[using$Ever_medicaid ==0] <- "No Medicaid Expansion"
using$Medicaid_ever[using$Ever_medicaid ==1] <- "Medicaid Expansion"
trends <- aggregate(x=using_model$estab_pop, by = list(using_model$YEAR.id, using_model$Medicaid_ever), FUN = mean)
View(trends)
trends <- aggregate(x=using$estab_pop, by = list(using$YEAR.id, using$Ever_medicaid), FUN = mean)
trends <- aggregate(x=using$estab_pop, by = list(using$YEAR.id, using$Ever_medicaid, using$Uber_active), FUN = mean)
View(trends)
trends$Group.4[trends$Group.2==1 & trends$Group.3==1] <- "Medicaid Expansion & Uber Active"
trends$Group.4[trends$Group.2==1 & trends$Group.3==1] <- "Medicaid Expansion & Uber Active"
trends$Group.4[trends$Group.2==1 & trends$Group.3==0] <- "Medicaid Expansion & No Uber"
trends$Group.4[trends$Group.2==0 & trends$Group.3==1] <- "No Expansion & Uber Active"
trends$Group.4[trends$Group.2==0 & trends$Group.3==0] <- "No Expansion & No Uber"
ggplot(data = trends,
aes(group = Group.4,
x = Group.1,
y = x,
# color = Group.5,
shape = Group.4)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 14.5, color = "red")+
xlab("Year") +
ylab("Uber is Active") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
ggplot(data = trends,
aes(group = Group.4,
x = Group.1,
y = x,
# color = Group.5,
shape = Group.4)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 14.5, color = "red")+
xlab("Year") +
ylab("Nonemployer Estab./Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
pdf(paste0("Medicaid Expansion Trend by Medicaid and Uber.pdf"), width = 11, height = 8)
ggplot(data = trends,
aes(group = Group.4,
x = Group.1,
y = x,
# color = Group.5,
shape = Group.4)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 14.5, color = "red")+
xlab("Year") +
ylab("Nonemployer Estab./Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
dev.off()
# Ben Glasner
# Medicaid and nonemployers analysis
# Industry analysis of nonemployers
# Perform panel analysis in R to get the stargazer output for latex
##################
###  Library   ###
##################
library(stargazer)
library(sjPlot)
library(estimatr)
library(ggplot2)
library(broom)
library(scales)
library(devtools)
library(dplyr)
# install_github("sgaure/lfe")
# install_github("xuyiqing/gsynth")
# remotes::install_version("lfe", version="2.8-5.1")
library(lfe)
library(gsynth)
library(did)
#################
### Set paths ###
#################
if(Sys.info()[["user"]]=="bglasner"){
# Root folder
path_project <- "C:/Users/bglasner/Dropbox/PhD Requirements"
}
if(Sys.info()[["user"]]=="bngla"){
# Root folder
path_project <- "C:/Users/bngla/Dropbox/PhD Requirements"
}
# Path to saved cohort data
path_data <- paste0(path_project,"\\Nonemployer data\\Data\\")
# Path where matched samples should be saved
path_output <- paste0(path_project,"\\ACA and alt\\output")
setwd(paste0(path_data))
options(scipen=10000)
set.seed(42)
industry_analysis <- 1
load("state_NES_ACS_CPS.RData")
load("LAU.RData")
LAU_st <- aggregate(x = LAU$`Labor Force`, by = list(LAU$st, LAU$YEAR.id), FUN = sum, na.rm = TRUE)
colnames(LAU_st)[1] <- "st"
colnames(LAU_st)[2] <- "YEAR.id"
colnames(LAU_st)[3] <- "Labor.Force"
state_aggs <- merge(state_aggs, LAU_st)
state_aggs$estab_pop <- state_aggs$estab/state_aggs$Labor.Force
estab_list <- list()
View(state_aggs)
View(state_aggs)
trends_estab_pop <- aggregate(x=state_aggs$estab_pop, by = list(using$YEAR.id, using$Ever_medicaid), FUN = mean)
trends_estab_pop <- aggregate(x=state_aggs$estab_pop, by = list(state_aggs$YEAR.id, state_aggs$Ever_medicaid), FUN = mean)
View(trends_estab_pop)
ddply(state_aggs, .(assetclass), function(x) data.frame(wret=weighted.mean(x$estab_pop, x$Labor.Force)))
#################################################################
#                         Descriptive Plot                      #
#################################################################
library(plyr)
ddply(state_aggs, .(assetclass), function(x) data.frame(wret=weighted.mean(x$estab_pop, x$Labor.Force)))
ddply(state_aggs, .(YEAR.id), function(x) data.frame(wret=weighted.mean(x$estab_pop, x$Labor.Force)))
ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$estab_pop, x$Labor.Force)))
trends_estab_pop <- ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$estab_pop, x$Labor.Force)))
View(trends_estab_pop)
names(state_aggs)
trends_Estab_pct_ACS <- ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$Estab_pct_ACS, x$Labor.Force)))
trends_Estab_pct_CPS <- ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$Estab_pct_CPS, x$Labor.Force)))
View(trends_Estab_pct_ACS)
View(trends_Estab_pct_CPS)
trends <- rbind(trends_estab_pop,trends_Estab_pct_ACS,trends_Estab_pct_CPS)
View(trends)
trends_estab_pop$Group <- "NES"
trends_Estab_pct_ACS$Group <- "ACS"
trends_Estab_pct_CPS$Group <- "CPS"
trends <- rbind(trends_estab_pop,trends_Estab_pct_ACS,trends_Estab_pct_CPS)
View(trends)
trends_estab_pop <- ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$estab_pop, x$Labor.Force)))
trends_Estab_pct_ACS <- ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$Estab_pct_ACS, x$Labor.Force)))
trends_Estab_pct_CPS <- ddply(state_aggs, .(YEAR.id, Ever_medicaid), function(x) data.frame(wret=weighted.mean(x$Estab_pct_CPS, x$Labor.Force)))
trends_estab_pop$Data <- "NES"
trends_Estab_pct_ACS$Data <- "ACS"
trends_Estab_pct_CPS$Data <- "CPS"
trends <- rbind(trends_estab_pop,trends_Estab_pct_ACS,trends_Estab_pct_CPS)
View(trends)
trends$Group[trends$Data== "NES" & trends$Ever_medicaid==1] <- "NES , Medicaid Expanded"
trends$Group[trends$Data== "NES" & trends$Ever_medicaid==0] <- "NES , No Expansion"
trends$Group[trends$Data== "ACS" & trends$Ever_medicaid==1] <- "ACS , Medicaid Expanded"
trends$Group[trends$Data== "ACS" & trends$Ever_medicaid==0] <- "ACS , No Expansion"
trends$Group[trends$Data== "CPS" & trends$Ever_medicaid==1] <- "CPS , Medicaid Expanded"
trends$Group[trends$Data== "CPS" & trends$Ever_medicaid==0] <- "CPS , No Expansion"
ggplot(data = trends,
aes(group = Group,
x = wret,
y = YEAR.id,
# color = Group.5,
shape = Group)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 14.5, color = "red")+
xlab("Year") +
ylab("Unincorporated Self-Employed/Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
ggplot(data = trends,
aes(group = Group,
x = YEAR.id,
y = wret,
# color = Group.5,
shape = Group)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 14.5, color = "red")+
xlab("Year") +
ylab("Unincorporated Self-Employed/Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
ggplot(data = trends,
aes(group = Group,
x = YEAR.id,
y = wret,
# color = Group.5,
shape = Group)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 2014, color = "red")+
xlab("Year") +
ylab("Unincorporated Self-Employed/Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
ggplot(data = trends,
aes(group = Group,
x = YEAR.id,
y = wret,
# color = Group.5,
shape = Group)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 2014, color = "red")+
xlab("Year") +
ylab("Uninc.Self-Emp./Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
setwd(path_output)
pdf(paste0("Medicaid Expansion Trend by Medicaid and data.pdf"), width = 11, height = 8)
ggplot(data = trends,
aes(group = Group,
x = YEAR.id,
y = wret,
# color = Group.5,
shape = Group)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 2014, color = "red")+
xlab("Year") +
ylab("Uninc.Self-Emp./Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
dev.off()
pdf(paste0("Medicaid Expansion Trend by Medicaid and data.pdf"), width = 13, height = 8)
ggplot(data = trends,
aes(group = Group,
x = YEAR.id,
y = wret,
# color = Group.5,
shape = Group)) +
geom_point(size = 2.5) +
geom_line() +
geom_vline(xintercept = 2014, color = "red")+
xlab("Year") +
ylab("Unincorp. Self-Emp./Labor Force") +
theme(plot.title = element_blank(),
axis.text.x = element_text(size = 25, angle = 90),
axis.text.y = element_text(size = 25),
axis.title.y = element_text(size = 25),
axis.title.x = element_text(size = 25),
panel.background = element_rect(fill = "white"),
panel.grid = element_line(colour = "grey"),
axis.line = element_line(colour = "black"),
legend.position = "bottom",
legend.background = element_rect(fill=NA),
legend.text = element_text(size = 20),
legend.key = element_rect(fill="white"),
legend.title = element_blank()) +
guides(col = guide_legend("Lines",nrow=2,override.aes = list(size=2), order = 1),
shape = guide_legend(nrow=2,order = 2))
dev.off()
